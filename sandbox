  def index
    per_page = 1
     page = params[:page] || 1
     @q = params[:q]
     order = "updated_at DESC"
       begin

       @stories = Story.active.featured.paginate :page => page, :order => order, :per_page => per_page  
       rescue
         flash[:notice] = "There are no recent stories. \r\n Why not write your own?"
         redirect_to write_url
       else 
          respond_to do |format|
             format.html # index.html.erb
             format.xml  { render :xml => @stories }
             format.rss
           end  
       end   
  end
  
  def featured
    per_page = 30
     page = params[:page] || 1
     @q = params[:q]
     order = "updated_at DESC"
       begin

       @stories = Story.active.featured.paginate :page => page, :order => order, :per_page => per_page  
       rescue
         flash[:notice] = "There are no recent stories. \r\n Why not write your own?"
         redirect_to write_url
       else 
          respond_to do |format|
             format.html # index.html.erb
             format.xml  { render :xml => @stories }
             format.rss
           end  
       end   
  end
  
  def popular 
      per_page = 15
      page = params[:page] || 1
      @q = params[:q]
      order = "counter DESC, comments_count DESC, rating DESC, created_at DESC"
  
      begin

        @stories = Story.active.popular.paginate :page => page, :order => order, :per_page => per_page   
        rescue
          flash[:notice] = "There are no popular stories. Why not write your own?"
          redirect_to write_url
        else 
           respond_to do |format|
              format.html # index.html.erb
              format.xml  { render :xml => @stories }
              format.rss
            end  
        end
  
  end
  
  def commented 
      per_page = 15
      page = params[:page] || 1
      @q = params[:q]
      order = "updated_at DESC, comments_count DESC"
  
      begin

        @stories = Story.active.commented.paginate :page => page, :order => order, :per_page => per_page   
        rescue
          flash[:notice] = "There are no exceptionally active stories. Why not write your own?"
          redirect_to write_url
        else 
           respond_to do |format|
              format.html # index.html.erb
              format.xml  { render :xml => @stories }
              format.rss
            end  
        end
  
      
  end      
        

  
  def recent
    per_page = 15
    page = params[:page] || 1
    @q = params[:q]
    order = "created_at DESC"
#    timeThen = Time.zone.now.advance(:months => -6)
      begin
  
      @stories = Story.active.recent.paginate :page => page, :order => order, :per_page => per_page   
      rescue
        flash[:notice] = "There are no recent stories. Why not write your own?"
        redirect_to write_url
      else 
         respond_to do |format|
            format.html # index.html.erb
            format.xml  { render :xml => @stories }
            format.rss
          end  
      end
  end

  def top
    per_page = 15
    page = params[:page] || 1
    order = "rating DESC"
    begin
    @stories = Story.active.top.paginate :page => page, :order => order, :per_page => per_page   
    rescue
        flash[:notice] = "There are no recent stories. Why not write your own?"
        redirect_to write_url
    else
    respond_to do |format|
      format.html # index.html.erb
      format.xml  { render :xml => @stories }
      format.rss
    end
    end
  end


search: 
<div id="search_container">

	<% form_tag '/search', :method => :get do -%>
	
		<%= text_field_tag 'q', 
			"Type your search. Hit enter.", 
			:tabindex => "20", 
			:onFocus => 'clearFieldFirstTime(this);' %>

	<% end -%>


</div>



background:url(../images/comment_icon.png) center no-repeat;

######## description drawer ############
/*  	This is what moves when you click "description"			*/
#description_slide_toggle {
	width:92px;
	cursor:pointer;
	vertical-align:baseline;
	text-align:left;

}

#description_drawer {
	width:100%;
}

######### Twitter Widget ###############

<h2>Updates</h2>

<!-- twitter widget -->
<div id="twitter_widget">
<div id="twtr-search-widget"></div>
<script src="http://widgets.twimg.com/j/1/widget.js"></script>
<script>
new TWTR.Widget({
  search: '@6minutestory OR \"six minute story\" OR sixminutestory OR from:6minutestory',
  id: 'twtr-search-widget',
  loop: true,
  title: 'Recent tweets about',
  subject: 'Six Minute Story',
  width: 230,
  height: 300,
  theme: {
    shell: {
      background: '#a75ac1',
      color: '#ffffff'
    },
    tweets: {
      background: '#ffffff',
      color: '#444444',
      links: '#1985b5'
    }
  }
}).render().start();
</script>
</div>
<!-- end twitter widget -->

######### Close Twitter Widget #########

######### Ratings stuff #################


/
<%= link_to_remote "Shrug", 
	:url => user_story_votes_path(@story.user_id, @story, :vote => :false), 
	:method => :post
%> 

<%= content_tag 'SPAN', 
		("<a>[details]</a>"),
		:class => "details",
		:onClick => visual_effect(
			:toggle_blind,@vote_element,
			:duration => 0.3) 			
%>

</span>
<div id="<%=@vote_element%>" style="display:none;">
<span>
	<% 
	shrug = "shrug"
	love = "love"
	%>
	<%= @story.votes_for %> loves,
</span>
<span>
	<%= @story.votes_against %> shrugs
</span>
</div>

######### close ratings stuff ###############
truncate(h(@story.website))

    order = "created_at DESC"
, :order => order



 :field_weights => {"tag_names" => 100, "title" =>
1, "description" => 1, "license" => 1 },

<%= javascript_include_tag :all, :cache => true %>

page = params[:page] || 1
per_page = 10
condition = true
order = "created_at DESC"

.paginate(:per_page => per_page, :page => page)