<% content_for :sideyard do %>

	<div id="prompt_and_timer" style="display:none;">
		<div id="prompt_container" class="prompt_container" >
			<div id="timer_container" class="orange button_container">
				<div id="timer_element">
				</div>
				<!-- the timer is held in the application.js -->
			</div>
					<%= render :partial => "prompts/show_prompt" %>

			
		</div>

	</div><!-- Prompt and Timer container -->
	<div id="instructions">
	<h2>
		Options
	</h2>
		<p><%= link_to "Write using another prompt", prompts_url %></p>
		<p><%= link_to "Write to a blank (freeform) prompt", write_to_prompt_url(25) %></p>
		<p><%= link_to "Write to a random prompt", random_prompt_url %>
		
	<h2>
		Instructions
	</h2>
	<ol>
		<li>When you click in the writing box, you get a <em>prompt</em>.</li>
		<li>Then you have <strong>six minutes</strong> to write a <em>story</em>.</li>
		<li>Go!</li>
	</ol>
	<p>	
		When the timer stops, <em>you won't be able to type anymore</em>, so use the last seconds <strong>wisely</strong>. 
	</p>
	<p>	
		<em>Before submitting</em> choose a <strong>title</strong>, relevant <strong>tags</strong> and a <strong>license</strong> for your story.
	</p>
</div>
<% end %>
<%= javascript_include_tag "prototype", "effects" %>






<h1>Write a story</h1>
<div id="new_story_container" class="new_story_container">
	<% if @story.errors.any? %>
		<!-- ERROOOOOOOooooOOORSSSSSSSSSSSSSSSSS -->

	<div id="errorExplanation">
		<h2>Your story hasn't been saved yet.</h2>
		<h3>Please check for errors below.</h3>

		  <ul>
		    <% @story.errors.each do |attribute, msg| %>
		      <li><%= msg %></li>
		    <% end %>
		  </ul>
	</div>
	<% end %>


<%= form_for(@story) do |f| %>

	<!-- Include the prompt so we can use it on the next page. Is this really necessary? -->
	<%= hidden_field_tag :prompt, @prompt.id %>
		
			<% if @story.description.present? || @editing.present?
				 @description = @story.description
				 @disabled = true
			%>	
				<script type="text/javascript">
					window.onload=function(){
						document.getElementById('story_description').disabled=true;
					}
				</script>
				
			<% 
				else
					@disabled = false
					@description = "when you click here \nthe prompt will appear to the right \nand the timer will start"
			
				end
			%>
					
			<%= f.text_area :description, :value => @description, :rows => 12, :cols => 45, :tabindex => "1", :onFocus => "Effect.Appear('prompt_and_timer',{duration:0.1});Effect.Fade('instructions',{duration:0.1});getSetWrite(this);" %>
</div>
<div class="space"></div>

<h1>Story details</h1>

<div class="new_story_container">
	<table>
		
		<tr>
			
			<th>
				 <% if @story.errors[:title].present? %>
					<label><%= @story.errors[:title] %></label>
				<% else %>
				<label for="story_title">Title</label>
				
				<% end %>
					
			</th>
			
			<td>	
		  		<%= f.text_field :title, :onFocus => 'clearFieldFirstTime(this);', :tabindex => "2" %>
			</td>
		</tr>

		<tr>	
			<th>
				<label for="story_tags">Adjectives</label><br />
				<span style="font-size:x-small">separate adjectives with commas</span>
			</th>
			<td>	
						
		 			<%= f.text_field :tag_list, :onFocus => 'clearFieldFirstTime(this);', :tabindex => "3" %>
				
	  		</td>
		</tr>
		<tr>	
			<th>
				<label for="story_genres">Genres</label><br />
				<span style="font-size:x-small">separate genres with commas</span>
			</th>
			<td>	
		 			<%= f.text_field :genre_list, :onFocus => 'clearFieldFirstTime(this);', :tabindex => "4" %>
				
	  		</td>
		</tr>
		
		<tr>
			<th>
				<label for="story_license">License</label>
			</th>
			<td>
				
				<select name="story[license]" id="story_license" onchange="" tabindex="5">
					<option value="Creative Commons Attribution 3.0">
						Creative Commons Attribution 3.0</option>
			
					<option value="Creative Commons Attribution-NoDerivs 3.0">
						Creative Commons Attribution-NoDerivs 3.0</option>
						
					<option value="Creative Commons Attribution-NonCommerical-NoDerivs 3.0">
						Creative Commons Attribution-NonCommercial-NoDerivs 3.0</option>
			
					<option value="Creative Commons AttributionNonCommerical 3.0">
						Creative Commons Attribution-NonCommercial 3.0</option>
			
					<option value="Creative Commons Attribution-NonCommerical-ShareAlike 3.0">
						Creative Commons Attribution-NonCommercial-ShareAlike 3.0</option>
			
					<option value="Creative Commons Attribution-ShareAlike 3.0" selected="selected">
						Creative Commons Attribution-ShareAlike 3.0</option>
					<option value="Public Domain">Public Domain</option>
					
				</select>
			</td>
		</tr>
	</table>
	
	<div class="clear space">
	</div>
			<br />
				<p>
				<%= submit_tag("Publish Your Story", :name => "save", :id => "save-button", :tabindex => "8", :onclick => "document.getElementById('story_description').disabled=false;") %>
				 
				</p>

<% end %>
</div>

