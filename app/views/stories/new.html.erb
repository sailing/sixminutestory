<% content_for :sideyard do %>
	<h2>
		Options
	</h2>
		<p><%= link_to "Write using another prompt", past_prompts_url %></p>
		
	<h2>
		Instructions
	</h2>
	<p>You get <em>six minutes</em> to write a story <strong>based on the prompt</strong>. 
	</p>
	<p>	
		When the timer stops, <em>you won't be able to type anymore</em>, so use the last seconds <strong>wisely</strong>. 
	</p>
	<p>	
		<em>Before submitting</em> choose a <strong>title</strong>, relevant <strong>tags</strong> and a <strong>license</strong> for your story.
	</p>

<% end %>

<%= javascript_include_tag "prototype", "effects", :cache => true %>


<div id="prompt_and_timer" style="display:none;">
	<%= render :partial => 'prompt' %>
	
	<div id="timer_container" class="orange button_container">
		<span id="timer_element" >
		</span>
	</div>
</div><!-- Prompt and Timer container -->




<div id="new_story_form">
<% form_for(@story) do |f| %>
	<%= hidden_field_tag :prompt, @prompt.id %>

<% unless f.error_messages.empty? %>
<h1>Errors</h1>
<div id="errorExplanation">
	<h2>Your story hasn't been saved yet.</h2>
	<h3>Please check for errors below.</h3>
</div>
<% end %>

<h4>Write your story</h4>

	<div class="center">

			<%= f.error_message_on 'description' %>
			
		
			<% if @story.description.present? || @editing.present?
				 @description = @story.description
				
				if @editing.present? 
					@disabled = true 
				end
			%>	
				<script type="text/javascript">
					window.onload=function(){
						document.getElementById('story_description').disabled=true;
					}
				</script>
				
			<% 
				else
					@disabled = false
					@description = "when you click here the prompt will appear and the timer will start"
			
				end
			%>
					
			<%= f.text_area :description, :value => @description, :rows => 20, :cols => 45, :tabindex => "1", :onFocus => "Effect.Appear('prompt_and_timer',{duration:0.1});getSetWrite(this);" %>
</div>

<div class="clear space">
</div>

<h4>Title, Describe and <br/> License your story</h4>

	<table>
		<tr>
			<td colspan=2>
				<%= f.error_message_on 'title' %>
			</td>
		
			<td colspan=2>
			</td>
		</tr>
		<tr>
			
			<th>
				<label for="story_title">Title</label>
			</th>
			<td>	
		  		<%= f.text_field :title, :disabled => @disabled, :onFocus => 'clearFieldFirstTime(this);', :value => @title, :tabindex => "2" %>
			</td>
			<th>
				<label for="story_tags">Adjectives</label>
			</th>
			<td>	
					<% if @story.tags.present? -%>
						<% @story.tags.each do |tag| -%>
			   				<%= tag %>
						<% end -%>
					<% end -%>
		 			<%= f.text_field :tag_list, :onFocus => 'clearFieldFirstTime(this);', :value => @tags, :tabindex => "3" %>
	  		</td>
		</tr>
		<tr>
			<td colspan=4>
				&nbsp; 	<%= f.error_message_on 'license' %>
			</td>
		</tr>
		<tr>
			<th>
				<label for="story_license">License</label>
			</th>
			<td colspan=3>
				
				<select name="story[license]" id="story_license" onchange="" tabindex="4">
					<option value="Creative Commons Attribution 3.0">
						Creative Commons Attribution 3.0</option>
			
					<option value="Creative Commons Attribution-NoDerivs 3.0">
						Creative Commons Attribution-NoDerivs 3.0</option>
						
					<option value="Creative Commons Attribution-NonCommerical-NoDerivs 3.0">
						Creative Commons Attribution-NonCommercial-NoDerivs 3.0</option>
			
					<option value="Creative Commons AttributionNonCommerical 3.0">
						Creative Commons Attribution-NonCommercial 3.0</option>
			
					<option value="Creative Commons Attribution-NonCommerical-ShareAlike 3.0">
						Creative Commons Attribution-NonCommercial-ShareAlike 3.0</option>
			
					<option value="Creative Commons Attribution-ShareAlike 3.0" selected="selected">
						Creative Commons Attribution-ShareAlike 3.0</option>
					<option value="Public Domain">Public Domain</option>
					
				</select>
			</td>
		</tr>
	</table>
	
	<div class="clear space">
	</div>
<h4>Prove you're human</h4>
		<div class="center">
			<p>
					<% unless @editing.present? %>
						<% if session[:recaptcha_error].present? %>
						 	<span class="formError">Incorrect text entered.</span>
						<% end %>

						<%= recaptcha_tags :display => {:tabindex => "5"} %>
					<% end %>

				
			</p>
			<br />
				<p>
				<%= image_submit_tag("save.png", :name => "save", :id => "save-button", :tabindex => "6", :onclick => "document.getElementById('story_description').disabled=false;") %>
				 <% if current_user.id == @story.user_id %>
						<%= link_to 'Destroy story', @story, :confirm => 'Are you sure you want to remove this story? Your story will no longer be visible!', :method => :delete %>
						<% end %>
				</p>

</div>
<% end %>
</div>

