<% content_for :pagename do %>
  <%= @story.title %>
<% end %>
<div class="row">
  <div class="col-1">
    <div class="row">
      <%= link_to story_url(@previous), class: "col-12 btn btn-large border increment-story increment-story-left" do %>
        <i class="icon-caret-left icon-large"></i>
      <% end %>
    </div>
    <div class="row">
      <%= link_to random_stories_url, class: "col-12 border border-top-0 btn btn-large increment-story increment-story-random" do %>
        <i class="icon-random icon-large"></i>
      <% end %>
    </div>
  </div>
  <div class="col-10">
    <%= render :partial => "stories/story", :locals => {:story => @story} %>
  </div>
  <% if @next %>
    <%= link_to story_url(@next), class: "col-1 btn btn-large border increment-story" do %>
      <i class="icon-caret-right icon-large"></i>
    <% end %>
  <% end %>
</div>
<div class="row m-2 mt-5 d-flex justify-content-between">
  <div class="flex-fill col-12 col-md-6">
    <div class="card">
      <h3 class="card-header bg-info text-white">Comments</h3>
      <%= render :partial => "comment_section" %>
    </div>
  </div>
  <div class="flex-fill col-12 col-md-6">
    <%= render :partial => "site/profile_block" %>
    <div class="card mb-3" id="favoriters">
      <%= render :partial => "favoriters" %>
    </div>
    <div class="card mb-3">
      <h3 class="card-header">Story information   </h3>
      <div class="card-content p-3">
        <h6>License</h6>
        <p>
          <%= @story.license %>
        </p>
        <% if @story.genres.any? %>
          <h6>genres</h6>
          <p>
            <% @story.genres.each do |genre| %>
              <%= link_to h(genre.name), subset_stories_url(:tag => genre.name, :subset => "genre", :months => 100) %>
            <% end %>
          </p>
        <% end %>
        <% if @story.tags.any? %>
          <h6>tags</h6>
          <p>
            <% @story.tags.each do |tag| %>
              <%= link_to h(tag.name), subset_stories_url(:tag => tag.name, :subset => "adjective", :months => 100) %>
            <% end %>
          </p>
        <% end %>
      </div>
    </div>
    <div class="card" id="prompt">
      <h3 class="card-header">The prompt for this story</h3>
      <div class="card-content p-3">
        <%= render :partial => "prompts/show_prompt" %>
      </div>
      <div class="card-footer">
        <%= render :partial => "votes/prompt_vote", :object => @story.prompt, :as => :prompt %>
      </div>
    </div>
  </div>
  
</div>

<%- if is_admin %>
  <div class="row spacer">
    <div class="col-4 offset2">
      <%- if @story.featured == true %>
        <div id="unfollowing_button">
          <%= button_to "Unfeature", unfeature_story_url(@story), class: "btn col-12 btn-danger btn-superlarge",
                :confirm => 'Are you sure you want to unfeature this story? The story will no longer be featured!', :method => :post %>
        </div>
      <%- elsif @story.featured == false %>
        <div id="following_button" class="button_container">
          <%= button_to "Feature", feature_story_url(@story), class: "btn col-12 btn-primary btn-superlarge",
                :confirm => 'Are you sure you want to feature this story? The story will become featured!', :method => :post %>
        </div>
        <div class="col-4">
          <%= link_to "Edit Details", edit_story_url(@story), class: "btn col-12 btn-superlarge" %>
        </div>
      <%- end %>
    </div>
  </div>
<% end %>
