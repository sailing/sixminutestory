.story{class: ("card m-3 mt-5" if @stories)}
  - if @stories
    .card-header.bg-light
      %h2.mt-1.h3
        = link_to story.safe_title, story_url(story), class: "text-info"
        %small.text-muted
          by
          = link_to story.user.login, profile_path(story.user), class: "text-secondary"
          = time_ago_in_words(story.created_at) + " ago"

  .card-content.p-3
    - if @stories
      = simple_format(sanitize(truncate(story.description, :length => 500, separator: ' ', :omission => "...")))
      = link_to("Read more <i class='icon-circle-arrow-right'></i>".html_safe, story_url(story), class: "btn btn-success btn-mini")
    - else
      .row-fluid.story-itself
        .span10.offset1
          = simple_format(sanitize(story.description))

  %div{class: ("card-footer" if @stories)}
    %span.comments_in_footer
      / = link_to pluralize(story.comments_count, 'remark'), story_url(story, :anchor => "comments")
      = link_to raw(story.comments_count.to_s + " <i class='icon-comment'></i>"), story_url(story, :anchor => "comments"), class: "text-dark", rel: "tooltip", title: "#{story.comments_count.to_s} comments"

    - unless @stories
      %span &nbsp;|&nbsp;
      %span.favorites_in_footer
        #{render :partial => "votes/story_vote", :story => story}
    %span &nbsp;|&nbsp;
    %span.counter_in_footer
      / = pluralize(story.counter, 'view')
      = story.counter
      %i.icon-user
    - unless @stories
      - if is_user
        %span &nbsp;|&nbsp;
        %span.flag
          / This is how people flag stories
          = link_to flag_story_url(@story.id), :method => "post", rel: "tooltip", title: "Flag this as hateful" do
            %i.icon-flag

        - if is_owner_or_admin
          &nbsp;||&nbsp;
          = link_to edit_story_path(@story) do
            %i.icon-edit
            Edit
        - if is_admin
          &nbsp;|&nbsp;
          = @story.flagged
          %i.icon-flag


  

  - unless @stories
    .row-fluid.content
      .span6.offset3.text-center
        = render :partial => 'stories/share_in_story', :locals => {:story => story}